(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{663:function(t,i,e){var o=e(664);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);(0,e(6).default)("43b1de13",o,!1,{})},664:function(t,i,e){(t.exports=e(4)()).push([t.i,"\n.ql-container{min-height: 200px;\n}\n.ql-snow{line-height: 24px!important;\n}\n.edit_container{background: #ffffff;\n}\r\n",""])},665:function(t,i,e){var o=e(666);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);(0,e(6).default)("a44e104a",o,!1,{})},666:function(t,i,e){(i=t.exports=e(4)()).i(e(667),""),i.push([t.i,"\n",""])},667:function(t,i,e){(t.exports=e(4)()).push([t.i,".zmiti-informanagercomment-main-ui {\r\n  background: #f2f2f2;\r\n  box-sizing: border-box;\r\n  height: 100%;\r\n  width: 99%;\r\n  margin: 0 auto; }\r\n  .zmiti-informanagercomment-main-ui .zmiti-list-main {\r\n    box-sizing: border-box;\r\n    background: #fff;\r\n    margin: 0 auto; }\r\n  .zmiti-informanagercomment-main-ui .zmiti-list-where {\r\n    font-size: 14px;\r\n    width: 98%;\r\n    margin: 0 auto 10px auto;\r\n    display: flex;\r\n    display: -webkit-flex;\r\n    flex-flow: row; }\r\n    .zmiti-informanagercomment-main-ui .zmiti-list-where .zmiti-search-dates {\r\n      margin: 0 10px; }\r\n  .zmiti-informanagercomment-main-ui .zmiti-search-icon {\r\n    font-size: 20px;\r\n    cursor: pointer; }\r\n  .zmiti-informanagercomment-main-ui .zmiti-tabs-select {\r\n    width: 98%;\r\n    margin: 0 auto; }\r\n  .zmiti-informanagercomment-main-ui .zmiti-parent-info {\r\n    width: 98%;\r\n    margin: 0 auto;\r\n    font-size: 14px;\r\n    padding: 0 0 10px 0;\r\n    display: flex;\r\n    display: -webkit-flex;\r\n    flex-flow: row; }\r\n    .zmiti-informanagercomment-main-ui .zmiti-parent-info label {\r\n      width: auto;\r\n      font-weight: bold; }\r\n  .zmiti-informanagercomment-main-ui .zmiti-submit-main {\r\n    margin-top: 10px;\r\n    flex: 5;\r\n    -webkit-flex: 5;\r\n    width: 100%; }\r\n    .zmiti-informanagercomment-main-ui .zmiti-submit-main > div {\r\n      -webkit-transition: 0.3s;\r\n      transition: 0.3s; }\r\n    .zmiti-informanagercomment-main-ui .zmiti-submit-main .zmiti-submit-table {\r\n      width: 98%;\r\n      margin: 0 auto; }\r\n\r\n.zmiti-add-form {\r\n  flex: 1;\r\n  -webkit-flex: 1;\r\n  width: 500px;\r\n  overflow: auto;\r\n  position: absolute !important;\r\n  top: 0;\r\n  right: 0;\r\n  z-index: 100;\r\n  height: 100%;\r\n  position: relative;\r\n  box-shadow: 0 0 0 1px #ccc;\r\n  box-sizing: border-box;\r\n  background: #f9f9f9; }\r\n  .zmiti-add-form .zmiti-safe-content {\r\n    display: flex;\r\n    display: -webkit-flex;\r\n    flex-flow: row;\r\n    -webkit-align-items: center;\r\n    align-items: center;\r\n    margin-top: 30px;\r\n    justify-content: space-around;\r\n    -webkit-justify-content: space-around;\r\n    border: 1px dashed #ccc;\r\n    padding: 10px 0; }\r\n    .zmiti-add-form .zmiti-safe-content > div:nth-of-type(1) {\r\n      text-align: center;\r\n      width: 120px;\r\n      font-weight: bold; }\r\n    .zmiti-add-form .zmiti-safe-content > div:nth-of-type(2) {\r\n      flex: 1;\r\n      -webkit-flex: 1; }\r\n    .zmiti-add-form .zmiti-safe-content > div:nth-of-type(3) {\r\n      width: 80px;\r\n      cursor: pointer;\r\n      text-align: center;\r\n      color: #0066cc; }\r\n  .zmiti-add-form.detail-enter-active, .zmiti-add-form.detail-leave-active {\r\n    -webkit-transition: 0.2s;\r\n    transition: 0.2s; }\r\n  .zmiti-add-form.detail-enter, .zmiti-add-form.detail-leave-to {\r\n    -webkit-transform: translateX(100%);\r\n    transform: translateX(100%); }\r\n  .zmiti-add-form .zmiti-submit-avatar {\r\n    background: rgba(51, 144, 255, 0.1);\r\n    border-radius: 50%;\r\n    text-align: center;\r\n    width: 80px;\r\n    height: 80px;\r\n    line-height: 80px;\r\n    margin: 0 auto 30px;\r\n    cursor: pointer;\r\n    position: relative; }\r\n    .zmiti-add-form .zmiti-submit-avatar label {\r\n      position: absolute;\r\n      bottom: -50px;\r\n      font-size: 12px;\r\n      width: 100%;\r\n      text-align: center;\r\n      left: 0; }\r\n    .zmiti-add-form .zmiti-submit-avatar span {\r\n      font-size: 40px;\r\n      color: rgba(51, 144, 255, 0.8); }\r\n  .zmiti-add-form .zmiti-add-form-C {\r\n    margin: 10px auto 2px;\r\n    width: 90%; }\r\n  .zmiti-add-form .zmiti-add-form-item {\r\n    line-height: 50px;\r\n    height: 50px; }\r\n    .zmiti-add-form .zmiti-add-form-item.zmiti-add-btns {\r\n      text-align: center;\r\n      position: relative;\r\n      z-index: 10; }\r\n      .zmiti-add-form .zmiti-add-form-item.zmiti-add-btns button {\r\n        margin: 0 20px;\r\n        padding: 2px 20px; }\r\n    .zmiti-add-form .zmiti-add-form-item input {\r\n      padding-left: 6px;\r\n      height: 32px;\r\n      width: 70%;\r\n      border: 1px solid #d8d8d8;\r\n      outline: none; }\r\n\r\n.zmiti-inforuserlist-select ul {\r\n  display: flex;\r\n  display: -webkit-flex;\r\n  flex-flow: row;\r\n  flex-wrap: wrap; }\r\n  .zmiti-inforuserlist-select ul li {\r\n    width: 120px; }\r\n\r\n.zmiti-select-column {\r\n  padding: 10px; }\r\n\r\n.zmiti-informanagerdetail-form {\r\n  padding: 20px; }\r\n\r\n.zmiti-scroll {\r\n  overflow: auto; }\r\n\r\n.zmiti-remove-icon {\r\n  cursor: pointer; }\r\n\r\n/*# sourceMappingURL=comment.css.map */\r\n",""])},780:function(t,i,e){"use strict";e.r(i);var o=e(0),n=e(2),r=e(9),a=e(10),s=e(64),l=e(91),{companyActions:d,zmitiActions:c,infomanagerActions:m,formatDate:u,userActions:f}=(e(92),n.a),h={props:["obserable"],name:"zmitiindex",data(){return{columntitle:"",articletitle:"",typename:"",myfiles:[],showAvatarModal:!1,showResource:!1,showWord:!1,showPdf:!1,companyname:"",addDataSource:[],imgs:window.imgs,total:0,loading:!0,currentCityIndex:-1,currentCityId:-1,transX:0,transY:0,viewH:window.innerHeight,viewW:window.innerWidth,showDetailPage:-1,currentChooseResource:{},currentChooseWord:{},currentChoosePdf:{},dataSource:[],showTable:!1,condition:{page_index:0,page_size:10},userinfo:{},id:"",typeid:1,productid:0,title:"",begin_time:0,end_time:0,companyid:"",userSource:[],selectUsers:"",filedisabled:!1,formObj:{title:"",productid:0,content:"",status:"1",wordurl:"",pdfurl:"",filearray:""},commentDetail:[],editorQuillOption:{modules:{toolbar:[["bold",{indent:"-1"},{indent:"+1"},{color:[]},{align:[]},"clean"]],syntax:{highlight:t=>hljs.highlightAuto(t).value}}},statusVal:"-1",selectStatus:[{value:"-1",label:"全部"},{value:"0",label:"禁用"},{value:"1",label:"待审"},{value:"2",label:"通过"},{value:"3",label:"拒绝"}],statusList:[{value:0,label:"禁用"},{value:1,label:"待审"},{value:2,label:"通过"},{value:3,label:"拒绝"}],columns:[{title:"编号",key:"infoid",align:"center",width:120},{title:"标题",key:"title",align:"center"},{title:"状态",key:"status",align:"center",render:(t,i)=>{let e="",o="#2d8cf0";switch(i.row.status){case 0:e="禁用",o="#000";break;case 2:e="通过",o="#19be6b";break;case 3:e="拒绝",o="#ed4014";break;default:e="待审"}return t("span",{style:{color:o}},e)}},{title:"时间",key:"createtime",align:"center",width:120,render:(t,i)=>t("div",{},u(i.row.createtime))},{title:"操作",key:"action",align:"center",width:180,render:(t,i)=>t("div",[t("span",{style:{cursor:"pointer",color:"rgb(0, 102, 204)",marginRight:"10px"},on:{click:()=>{this.getnewsDetail(i.row.infoid),o.default.obserable.trigger({type:"toggleMask",data:!0})}}},"编辑"),t("Poptip",{props:{confirm:!0,title:"确定要删除吗？",placement:"left"},on:{"on-ok":()=>{this.delete(i.row.infoid)}}},[t("span",{props:{type:"error",size:"small"},style:{cursor:"pointer",color:"#06C"},on:{click:()=>{}}},"删除")])])}]}},components:{ZmitiTable:r.a,ZmitiMask:a.a,ResourceList:s.a,quillEditor:l.quillEditor},beforeCreate(){},created(){this.companyid=n.a.getCurrentCompanyId().companyid},mounted(){this.id=this.$route.params.id,this.typeid=this.$route.params.typeid,this.productid=this.$route.params.productid,this.formObj.productid=this.$route.params.productid,this.typename=this.$route.params.typename,console.log(this.id,"this.id"),console.log(this.typeid,"this.typeid"),setTimeout(()=>{this.getnewsDetail(this.$route.params.id)},100),this.getDataList()},watch:{statusVal(){this.getDataList()},myfiles(){this.filedisabled=5===this.myfiles.length}},methods:{change(t){this.condition.page_index=t-1,this.getDataList()},goback(){window.history.go(-1)},selectDates(t){console.log(t,"选择的时间"),this.begin_time=Date.parse(new Date(t[0]))/1e3,this.end_time=Date.parse(new Date(t[1]))/1e3,console.log(this.begin_time+" "+this.end_time,"选择的时间戳")},searchHandle(){this.getDataList()},infoStatus(t){this.statusVal=t,this.condition.page_index=0,this.currentNumber=1,console.log(this.statusVal,"选中的状态")},closeMaskPage(){console.log("关闭右侧"),o.default.obserable.trigger({type:"toggleMask",data:!1})},add(){this.formObj={title:"",productid:this.$route.params.productid,content:"",status:"2",wordurl:"",pdfurl:"",filearray:""},o.default.obserable.trigger({type:"toggleMask",data:!0}),console.log(this.formObj,"this.formObj")},getDataList(){var t=this,{condition:i}=this;i=Object.assign(i,{typeid:t.typeid,fatherid:t.$route.params.id,productid:t.productid,title:t.title,begin_time:t.begin_time,end_time:t.end_time,status:t.statusVal}),n.a.ajax({remark:"getnewsList",data:{action:m.getnewsList.action,condition:i},error(){t.loading=!1},success(i){t.loading=!1,console.log(i,"获取列表"),0===i.getret?(t.total=i.total,i.total>0?t.dataSource=i.list:t.dataSource=[]):(t.$Message[0===i.getret?"success":"error"](i.msg||i.getmsg),t.dataSource=[])}})},adminAction(){var t=this,i=null!=this.formObj.infoid?m.editnews.action:m.addnews.action;let e=this.formObj;e.fatherid=this.$route.params.id,null!=this.formObj.infoid?(e.infoid=this.formObj.infoid,console.log(e.infoid,"评论编辑")):(e.typeid=this.typeid,console.log(e.infoid,"评论新增")),console.log(e,"评论的内容"),n.a.ajax({remark:this.formObj.infoid?"editnews":"addnews",data:{action:i,info:e},success(i){t.$Message[0===i.getret?"success":"error"](i.msg||i.getmsg),t.closeMaskPage(),t.getDataList(),window.location.reload()}})},contentChange(t){this.formObj.content=t},getnewsDetail(t){var i=this;console.log(t,"当前文章id"),n.a.ajax({remark:"getnewsDetail",data:{action:m.getnewsDetail.action,infoid:t,productid:i.productid},success(e){0===e.getret&&(i.$route.params.id==t?i.articletitle=e.info.title:(i.formObj=e.info,i.formObj.status=e.info.status.toString(),i.formObj.productid=i.productid,i.formObj.infoid=t,i.myfiles=e.info.filearray.split(","),console.log(i.formObj,"this.formObj")))}})},delete(t){var i=this;n.a.ajax({remark:"delnews",data:{action:m.delnews.action,productid:this.productid,infoid:t},success(t){i.$Message[0===t.getret?"success":"error"](t.msg||t.getmsg),i.getDataList()}})},onEditorReady(t){},onEditorBlur(){},onEditorFocus(){},onEditorChange(t,i,e){},onFinishWord(t){this.currentChooseWord=t},chooseWord(){this.showWord=!1,this.formObj.wordurl=this.currentChooseWord.filepath},onFinishPdf(t){this.currentChoosePdf=t},choosePdf(){this.showPdf=!1,this.formObj.pdfurl=this.currentChoosePdf.filepath},onFinished(t){this.currentChooseResource=t},chooseImg(){this.showResource=!1;this.currentChooseResource.filepath;this.myfiles.push(this.currentChooseResource.filepath),console.log(this.myfiles,"选择的文件"),this.formObj.filearray=this.myfiles.join(","),console.log(this.formObj.filearray,"全部文件地址")},filesHandle(t){let i=t.target.value,e=Number(t.target.id);this.myfiles[e]=i;let o=this.myfiles.join(",");this.formObj.filearray=o,console.log(this.myfiles,"更新后地址",o)},handleDelete(t){this.myfiles.splice(t,1);let i=this.myfiles.join(",");this.formObj.filearray=i,console.log(this.myfiles,"删除后地址",i)}},filters:{filterFun:function(t){return t&&t.length>20&&(t=t.substring(0,20)+"..."),t}}},p=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"zmiti-informanagercomment-main-ui"},[e("div",{staticClass:"zmiti-list-main"},[e("div",{staticClass:"zmiti-informanagernews-table lt-full"},[e("header",{staticClass:"zmiti-tab-header"},[e("div",[t._v("\n\t\t\t\t\t "+t._s(t._f("filterFun")(t.articletitle))+"\n\t\t\t\t ")]),t._v(" "),e("div",[e("Button",{attrs:{type:"primary"},on:{click:function(i){return t.add()}}},[t._v("添加")]),t._v(" "),e("Button",{attrs:{type:"default"},on:{click:function(i){return t.goback()}}},[t._v("返回")])],1)]),t._v(" "),e("div",{staticClass:"zmiti-submit-main zmiti-scroll",style:{height:t.viewH-110+"px"}},[e("section",{staticClass:"zmiti-list-where"},[e("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入评论标题"},model:{value:t.title,callback:function(i){t.title=i},expression:"title"}}),t._v(" "),e("div",{staticClass:"zmiti-search-dates"},[e("DatePicker",{staticStyle:{width:"200px"},attrs:{type:"daterange","start-date":new Date(2018,12,1),placement:"bottom-end",placeholder:"选择时间段"},on:{"on-change":t.selectDates}})],1),t._v(" "),e("Button",{attrs:{icon:"md-search"},on:{click:t.searchHandle}},[t._v("搜索")]),t._v(" "),e("Select",{staticStyle:{"margin-left":"auto",width:"120px"},on:{"on-change":t.infoStatus},model:{value:t.statusVal,callback:function(i){t.statusVal=i},expression:"statusVal"}},t._l(t.selectStatus,(function(i){return e("Option",{key:i.value,attrs:{value:i.value}},[t._v(t._s(i.label))])})),1)],1),t._v(" "),e("ZmitiTable",{attrs:{loading:t.loading,dataSource:t.dataSource,columns:t.columns,change:t.change,"page-size":t.condition.page_size,total:t.total}})],1)])]),t._v(" "),e("ZmitiMask",{on:{closeMaskPage:t.closeMaskPage},model:{value:t.showDetailPage,callback:function(i){t.showDetailPage=i},expression:"showDetailPage"}},[e("div",{attrs:{slot:"mask-content"},slot:"mask-content"},[e("transition",{attrs:{name:"detail"}},[e("section",{staticClass:"zmiti-add-form zmiti-scroll"},[e("header",{staticClass:"zmiti-add-header"},[e("img",{attrs:{src:t.imgs.back,alt:""},on:{click:t.closeMaskPage}}),t._v(" "),e("span",[t._v("评论")])]),t._v(" "),e("Form",{staticClass:"zmiti-add-form-C",attrs:{model:t.formObj,"label-width":80}},[e("FormItem",{attrs:{label:"标题："}},[e("Input",{attrs:{placeholder:"标题"},model:{value:t.formObj.title,callback:function(i){t.$set(t.formObj,"title",i)},expression:"formObj.title"}})],1),t._v(" "),e("FormItem",{attrs:{label:"内容："}},[e("div",{staticClass:"edit_container"},[e("quill-editor",{ref:"myQuillEditor",attrs:{options:t.editorQuillOption},on:{blur:function(i){return t.onEditorBlur(i)},focus:function(i){return t.onEditorFocus(i)},change:function(i){return t.onEditorChange(i)}},model:{value:t.formObj.content,callback:function(i){t.$set(t.formObj,"content",i)},expression:"formObj.content"}})],1)]),t._v(" "),e("FormItem",{attrs:{label:"word文件："}},[e("div",[e("Button",{attrs:{icon:"ios-cloud-upload-outline"},on:{click:function(i){t.showWord=!0}}},[t._v("选择word文件")])],1),t._v(" "),e("Input",{attrs:{placeholder:"请输入word文件地址",clearable:""},model:{value:t.formObj.wordurl,callback:function(i){t.$set(t.formObj,"wordurl",i)},expression:"formObj.wordurl"}})],1),t._v(" "),e("FormItem",{attrs:{label:"pdf文件："}},[e("div",[e("Button",{attrs:{icon:"ios-cloud-upload-outline"},on:{click:function(i){t.showPdf=!0}}},[t._v("选择pdf文件")])],1),t._v(" "),e("Input",{attrs:{placeholder:"请输入pdf文件地址",clearable:""},model:{value:t.formObj.pdfurl,callback:function(i){t.$set(t.formObj,"pdfurl",i)},expression:"formObj.pdfurl"}})],1),t._v(" "),e("FormItem",{attrs:{label:"附件："}},[e("div",[e("Button",{attrs:{icon:"ios-cloud-upload-outline",disabled:t.filedisabled},on:{click:function(i){t.showResource=!0}}},[t._v("选择附件")]),t._v(" 提示：最多添加5个文件")],1),t._v(" "),e("div",[e("ul",t._l(t.myfiles,(function(i,o){return e("li",{key:o},[e("Input",{attrs:{"element-id":o.toString(),value:i},on:{"on-change":t.filesHandle}},[e("Icon",{staticClass:"zmiti-remove-icon",attrs:{slot:"suffix",type:"ios-trash-outline",size:"20"},on:{click:function(i){return t.handleDelete(o)}},slot:"suffix"})],1)],1)})),0)])]),t._v(" "),e("FormItem",{attrs:{label:"状态："}},[e("RadioGroup",{model:{value:t.formObj.status,callback:function(i){t.$set(t.formObj,"status",i)},expression:"formObj.status"}},[e("Radio",{attrs:{label:"0"}},[t._v("禁用")]),t._v(" "),e("Radio",{attrs:{label:"1"}},[t._v("待审")]),t._v(" "),e("Radio",{attrs:{label:"2"}},[t._v("通过")]),t._v(" "),e("Radio",{attrs:{label:"3"}},[t._v("拒绝")])],1)],1)],1),t._v(" "),e("div",{staticClass:"zmiti-add-form-item zmiti-add-btns"},[e("Button",{attrs:{size:"large",type:"primary"},on:{click:t.adminAction}},[t._v(t._s(t.formObj.jobid?"保存":"确定"))])],1)],1)])],1)]),t._v(" "),e("Modal",{attrs:{title:"资料库",width:"800"},model:{value:t.showWord,callback:function(i){t.showWord=i},expression:"showWord"}},[t.showWord?e("ResourceList",{attrs:{isAdmin:!1,isDialog:!0},on:{onFinished:t.onFinishWord}}):t._e(),t._v(" "),e("div",{staticClass:"zmiti-resourcelist-footer",attrs:{slot:"footer"},slot:"footer"},[e("Button",{staticStyle:{width:"100px"},on:{click:function(i){t.showWord=!1}}},[t._v("取消")]),t._v(" "),e("Button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:t.chooseWord}},[t._v("确定")])],1)],1),t._v(" "),e("Modal",{attrs:{title:"资料库",width:"800"},model:{value:t.showPdf,callback:function(i){t.showPdf=i},expression:"showPdf"}},[t.showPdf?e("ResourceList",{attrs:{isAdmin:!1,isDialog:!0},on:{onFinished:t.onFinishPdf}}):t._e(),t._v(" "),e("div",{staticClass:"zmiti-resourcelist-footer",attrs:{slot:"footer"},slot:"footer"},[e("Button",{staticStyle:{width:"100px"},on:{click:function(i){t.showPdf=!1}}},[t._v("取消")]),t._v(" "),e("Button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:t.choosePdf}},[t._v("确定")])],1)],1),t._v(" "),e("Modal",{attrs:{title:"资料库",width:"800"},model:{value:t.showResource,callback:function(i){t.showResource=i},expression:"showResource"}},[t.showResource?e("ResourceList",{attrs:{isAdmin:!1,isDialog:!0},on:{onFinished:t.onFinished}}):t._e(),t._v(" "),e("div",{staticClass:"zmiti-resourcelist-footer",attrs:{slot:"footer"},slot:"footer"},[e("Button",{staticStyle:{width:"100px"},on:{click:function(i){t.showResource=!1}}},[t._v("取消")]),t._v(" "),e("Button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:t.chooseImg}},[t._v("确定")])],1)],1)],1)};p._withStripped=!0;var g=e(3),b=!1;var w=function(t){b||(e(663),e(665))},v=Object(g.a)(h,p,[],!1,w,"data-v-7ddd25f9",null);v.options.__file="components\\infomanager\\box\\comment.vue";i.default=v.exports}}]);