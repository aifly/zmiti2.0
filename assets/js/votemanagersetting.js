(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{692:function(t,e,i){var o=i(693);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);(0,i(6).default)("22d44fd2",o,!1,{})},693:function(t,e,i){(t.exports=i(4)()).push([t.i,"\n.zmiti-orderfood-main-ui[data-v-a8c3488c]{width:98%;height:98%;left:1%;top:1%;display:flex;display:-webkit-flex;flex-flow:row\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-left-table-C[data-v-a8c3488c]{flex:1;height:100%;background:#fff\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-left-table-C header[data-v-a8c3488c]{text-indent:1em;height:50px;line-height:50px;font-size:16px;border-bottom:1px solid #eee\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-left-table-C header .zmt_iconfont[data-v-a8c3488c]{font-size:16px;color:#ffdd8a;position:relative;margin-right:10px\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-left-table-C header .zmt_iconfont[data-v-a8c3488c]:before{content:'';width:16px;height:16px;border-radius:50%;background:#ffdd8a;opacity:.3;position:absolute;-webkit-transform:scale(1.8);transform:scale(1.8);left:0;top:0\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-left-table-C>header[data-v-a8c3488c]{display:flex;display:-webkit-flex;flex-flow:row;justify-content:space-between\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-left-table-C>header button[data-v-a8c3488c]{margin-right:1em\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-left-table-C .zmiti-orderfood-count[data-v-a8c3488c]{text-align:right;color:#3390ff;padding-right:1em;border:none\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-left-table-C .zmiti-orderfood-table[data-v-a8c3488c]{width:98%;margin:0 auto;border:1px solid #eee\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-left-table-C .zmiti-orderfood-table header[data-v-a8c3488c]{width:100%;display:flex;display:-webkit-flex;flex-flow:row;justify-content:space-around\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-left-table-C .zmiti-orderfood-table header span[data-v-a8c3488c]{margin:0 0px;text-align:center;text-indent:-.1em;width:50px;cursor:pointer;display:inline-block\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-left-table-C .zmiti-orderfood-table header span i[data-v-a8c3488c]{width:12px;font-size:24px\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-left-table-C .zmiti-orderfood-table .zmiti-orderfood-datepicker[data-v-a8c3488c]{display:flex;display:-webkit-flex;flex-flow:row;flex-wrap:wrap;justify-content:space-between\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-left-table-C .zmiti-orderfood-table .zmiti-orderfood-datepicker li[data-v-a8c3488c]{text-align:center;width:14%;height:70px;cursor:pointer;line-height:30px\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-left-table-C .zmiti-orderfood-table .zmiti-orderfood-datepicker li span[data-v-a8c3488c]{display:block\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-left-table-C .zmiti-orderfood-table .zmiti-orderfood-datepicker li.active[data-v-a8c3488c]{background:#3390ff;color:#fff\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-left-table-C .zmiti-orderfood-table .zmiti-orderfood-datepicker li.active span[data-v-a8c3488c]{color:#fff !important\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-left-table-C .zmiti-orderfood-table .zmiti-orderfood-datepicker li[data-v-a8c3488c]:hover{background:#3390ff;color:#fff\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-left-table-C .zmiti-orderfood-table .zmiti-orderfood-datepicker li:hover span[data-v-a8c3488c]{color:#fff !important\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-left-table-C .zmiti-orderfood-table .zmiti-orderfood-datepicker li.zmiti-orderfood-week[data-v-a8c3488c]:hover{background:transparent;color:#888\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-left-table-C .zmiti-orderfood-table .zmiti-orderfood-datepicker li.disabled[data-v-a8c3488c]{background-color:#eee;border-color:#eee;color:#57a3f3;cursor:not-allowed\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-right-setting[data-v-a8c3488c]{width:420px;margin-left:10px;background:#fff\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-right-setting>header[data-v-a8c3488c]{height:50px;line-height:50px;font-size:16px;text-indent:1em;border-bottom:1px solid #eee\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-right-setting>header .zmt_iconfont[data-v-a8c3488c]{font-size:16px;color:#975ae0;position:relative;margin-right:10px\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-right-setting>header .zmt_iconfont[data-v-a8c3488c]:before{content:'';width:16px;height:16px;border-radius:50%;background:#975ae0;opacity:.2;position:absolute;-webkit-transform:scale(1.8);transform:scale(1.8);left:0;top:0\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-right-setting .zmiti-allow-orderfood[data-v-a8c3488c]{width:90%;margin:20px auto\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-right-setting .zmiti-allow-orderfood>div[data-v-a8c3488c]{margin:2px 0\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-right-setting .zmiti-admin-setting[data-v-a8c3488c]{width:90%;margin:20px auto\n}\n.zmiti-orderfood-main-ui .zmiti-orderfood-right-setting .zmiti-admin-setting>div[data-v-a8c3488c]{margin:4px 0\n}\n",""])},760:function(t,e,i){"use strict";i.r(e);var o=i(11),r=i(0),a={data:()=>({productid:""}),components:{RoleGroup:o.a},mounted(){this.init()},watch:{$route:{handler(){var t=this.productid;t&&this.$router.push({path:"/votemanagersetting/"+t})}}},methods:{init(){var t=this,e=setInterval(()=>{if(r.default.productList){clearInterval(e);var i=this.$route.params.id;i||r.default.productList.forEach(e=>{t.$route.name.indexOf(e.producturl.substr(1))>-1&&(i=e.productid)}),this.$router.push({path:"/votemanagersetting/"+i}),this.productid=i}},100)}}},n=function(){var t=this.$createElement,e=this._self._c||t;return this.productid?e("RoleGroup",{attrs:{productid:this.productid}}):this._e()};n._withStripped=!0;var d=i(3),s=Object(d.a)(a,n,[],!1,null,null,null);s.options.__file="components\\votemanager\\setting\\index.vue";e.default=s.exports},779:function(t,e,i){"use strict";i.r(e);var o=i(0),r=i(2),a=i(10),{orderFoodActions:n,userActions:d}=r.a,s={props:["obserable"],name:"zmitiindex",data:()=>({datePicker:new Array(35),weeks:["日","一","二","三","四","五","六"],viewH:window.innerHeight,viewW:window.innerWidth,loading:!1,isalluser:1,monthdateCount:30,year:2019,endtime:"",today:0,currentYear:(new Date).getFullYear(),currentMonth:(new Date).getMonth()+1,users:[],imgs:window.imgs,begintime:"",month:7,dataSource:[],currentWeekIndex:-1,weekIndexOfFirstDay:0,orderFoodDetailData:[],columns:[{title:"姓名",key:"username",align:"center"},{title:"电话",key:"mobile",align:"center"},{title:"订餐人数",key:"number",align:"center"}],userinfo:{},userList:[],todayNumber:0,condition:{page_index:0,page_size:200}}),components:{ZmitiMask:a.a},beforeCreate(){},mounted(){this.goToToday(),this.today=(new Date).getDate()},watch:{$route:{handler(){var t=this.productid;t&&this.$router.push({path:"/orderfood/"+t})}}},methods:{goToToday(){this.setMonth((new Date).getFullYear(),(new Date).getMonth()+1),this.refresh()},refresh(){this.init(()=>{this.monthdateCount=this.getDateByMonth(),this.currentWeekIndex=this.getCurrentWeekIndex(),this.weekIndexOfFirstDay=this.getCurrentWeekIndex(1),this.getDataList(),this.getOrderFoodConfigTop(),this.loading=!0,this.statisticsOrderFoodUserCount(()=>{this.getDateRangeOrderFoodCount()})})},getDetail(t){o.default.obserable.trigger({type:"toggleMask",data:!0});var e=this,i=t-this.weekIndexOfFirstDay+1,a=[this.year,this.month,i].join("-");r.a.ajax({remark:"getOrderFoodDetailByDate",data:{action:n.getOrderFoodDetailByDate.action,condition:{companyid:r.a.getCurrentCompanyId().companyid,productid:e.$route.params.id,daytime:a}},success(t){0===t.getret&&(e.orderFoodDetailData=t.list)}})},closeMaskPage(){o.default.obserable.trigger({type:"toggleMask",data:!1})},dataChange(t,e){"month"===t?"add"===e?(this.month++,this.month>12&&(this.month=1)):(this.month--,this.month<1&&(this.month=12)):"add"===e?this.year++:this.year--,this.setMonth(this.year,this.month),this.monthdateCount=this.getDateByMonth(),this.currentWeekIndex=this.getCurrentWeekIndex(),this.weekIndexOfFirstDay=this.getCurrentWeekIndex(1),this.getOrderFoodConfigTop(),this.statisticsOrderFoodUserCount(()=>{this.getDateRangeOrderFoodCount()})},init(t){var e=this,i=setInterval(()=>{if(o.default.productList){clearInterval(i);var r=this.$route.params.id;r||o.default.productList.forEach(t=>{e.$route.name.indexOf(t.producturl.substr(1))>-1&&(r=t.productid)}),this.$router.push({path:"/orderfood/"+r}),this.productid=r,t&&t(r)}},100)},getOrderFoodConfigTop(){var t=this;r.a.ajax({remark:"getOrderFoodConfigTop",data:{action:n.getOrderFoodConfigTop.action,condition:{companyid:r.a.getCurrentCompanyId().companyid,productid:t.$route.params.id}},success(e){0===e.getret?(t.begintime=e.list.begintime,t.endtime=e.list.endtime,t.configid=e.list.configid,t.isalluser=e.list.isalluser,t.users=e.list.users.map(t=>t.userid)):t.$Message.error(e.msg)}})},setOrderFoodConfigTop(){var t=this;r.a.ajax({remark:"setOrderFoodConfigTop",data:{action:n.setOrderFoodConfigTop.action,info:{companyid:r.a.getCurrentCompanyId().companyid,isalluser:t.isalluser,productid:t.$route.params.id,begintime:t.begintime,endtime:t.endtime,configid:t.configid,users:t.users.join(",")}},success(e){t.$Message[0===e.getret?"success":"error"](e.msg)}})},getDateRangeOrderFoodCount(){var t=this;r.a.ajax({remark:"getDateRangeOrderFoodCount",data:{action:n.getDateRangeOrderFoodCount.action,condition:{companyid:r.a.getCurrentCompanyId().companyid,productid:t.$route.params.id,begintime:[t.year,t.month,"01"].join("-")+" 00:00:00",endtime:[t.year,t.month,t.monthdateCount<10?"0"+t.monthdateCount:t.monthdateCount].join("-")+" 23:59:59"}},success(e){t.loading=!1,0===e.getret?(t.dataSource=e.list,t.dataSource.forEach(e=>{var[i,o,r]=e.bookday.split("-");1*i===t.year&&1*o===t.currentMonth&&1*r===t.today&&(t.todayNumber=e.number)})):t.$Message.error(e.msg)}})},statisticsOrderFoodUserCount(t){var e=this;r.a.ajax({remark:"statisticsOrderFoodUserCount",data:{action:n.statisticsOrderFoodUserCount.action,condition:{companyid:r.a.getCurrentCompanyId().companyid,productid:e.$route.params.id,begintime:[e.year,e.month,"01"].join("-"),endtime:[e.year,e.month,e.monthdateCount<10?"0"+e.monthdateCount:e.monthdateCount].join("-")}},success(i){0===i.getret?t&&t():e.$Message.error(i.msg)}})},setMonth(t=(new Date).getFullYear(),e=(new Date).getMonth()+1){this.year=t,this.month=e},getCurrentWeekIndex(t){var{year:e,month:i}=this,o=new Date(e,i,0);return t&&(o.setYear(e),o.setMonth(i-1),o.setDate(1),o.setDate(t)),o.getDay()},getDateByMonth(){var{year:t,month:e}=this;return new Date(t,e,0).getDate()},getDataList(){var t=this,{condition:e}=this;e=Object.assign(e,{companyid:r.a.getCurrentCompanyId().companyid}),r.a.ajax({remark:"getCompanyUserList",data:{action:d.getCompanyUserList.action,condition:e},error(){t.loading=!1},success(e){t.loading=!1,0===e.getret&&(t.total=e.total,t.userList=e.list)}})},formatDate(t,e){if(t){switch(e||(e="yyyy-MM-dd H:mm:ss"),typeof t){case"string":t=new Date(t.replace(/-/,"/"));break;case"number":t=new Date(t)}if(!(!t instanceof Date)){var i={yyyy:t.getFullYear(),M:t.getMonth()+1,d:t.getDate(),H:t.getHours(),m:t.getMinutes(),s:t.getSeconds(),MM:(""+(t.getMonth()+101)).substr(1),dd:(""+(t.getDate()+100)).substr(1),HH:(""+(t.getHours()+100)).substr(1),mm:(""+(t.getMinutes()+100)).substr(1),ss:(""+(t.getSeconds()+100)).substr(1)};return e.replace(/(yyyy|MM?|dd?|HH?|ss?|mm?)/g,(function(){return i[arguments[0]]}))}}}}},c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"zmiti-orderfood-main-ui lt-full"},[i("div",{staticClass:"zmiti-orderfood-left-table-C"},[i("header",[t._m(0),t._v(" "),i("div",[i("Button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.goToToday}},[t._v("回到今天")]),t._v(" "),i("Button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.refresh}},[t._v("刷新")])],1)]),t._v(" "),i("header",{staticClass:"zmiti-orderfood-count"},[t._v("今日订餐人数："+t._s(t.todayNumber)+"人")]),t._v(" "),i("div",{staticClass:"zmiti-orderfood-table"},[i("header",[i("div",[i("span",{on:{click:function(e){return t.dataChange("year","reduce")}}},[i("Icon",{attrs:{type:"ios-arrow-back"}}),i("Icon",{attrs:{type:"ios-arrow-back"}})],1),t._v(" "),i("span",{on:{click:function(e){return t.dataChange("month","reduce")}}},[i("Icon",{attrs:{type:"ios-arrow-back"}})],1)]),t._v(" "),i("div",[t._v(t._s(t.year)+"年"+t._s(t.month)+"月")]),t._v(" "),i("div",[i("span",{on:{click:function(e){return t.dataChange("year","add")}}},[i("Icon",{attrs:{type:"ios-arrow-forward"}}),i("Icon",{attrs:{type:"ios-arrow-forward"}})],1),t._v(" "),i("span",{on:{click:function(e){return t.dataChange("month","add")}}},[i("Icon",{attrs:{type:"ios-arrow-forward"}})],1)])]),t._v(" "),i("ul",{staticClass:"zmiti-orderfood-datepicker"},[t._l(t.weeks,(function(e){return i("li",{key:e,staticClass:"zmiti-orderfood-week",staticStyle:{"font-weight":"bold","line-height":"40px",height:"40px"}},[t._v("\n\t\t\t\t\t\t"+t._s(e)+"\n\t\t\t\t\t")])})),t._v(" "),t._l(t.datePicker,(function(e,o){return i("li",{key:o,class:{disabled:o-t.weekIndexOfFirstDay+1>t.monthdateCount,active:o-t.weekIndexOfFirstDay+1===t.today&&t.year===t.currentYear&&t.month===t.currentMonth},on:{click:function(e){return t.getDetail(o)}}},[t.weekIndexOfFirstDay<=o?i("span",[t._v("\n\t\t\t\t\t\t\t"+t._s(o-t.weekIndexOfFirstDay+1>t.monthdateCount?o-t.weekIndexOfFirstDay+1-t.monthdateCount:o-t.weekIndexOfFirstDay+1)+"\n\t\t\t\t\t\t")]):t._e(),t._v(" "),t._l(t.dataSource.filter((function(e){return o-t.weekIndexOfFirstDay+1==1*e.bookday.split("-")[2]})),(function(e,r){return i("div",{key:r,staticStyle:{position:"relative",top:"2px"}},[o-t.weekIndexOfFirstDay+1==1*e.bookday.split("-")[2]?i("span",{staticStyle:{"font-size":"12px",color:"#888"}},[t._v("订餐:"+t._s(e.number)+"人")]):t._e()])}))],2)}))],2)])]),t._v(" "),i("div",{staticClass:"zmiti-orderfood-right-setting"},[t._m(1),t._v(" "),i("div",{staticClass:"zmiti-allow-orderfood"},[i("div",[t._v("允许订餐时间：")]),t._v(" "),i("TimePicker",{staticStyle:{width:"47%"},attrs:{placeholder:"请选择订餐开始时间"},model:{value:t.begintime,callback:function(e){t.begintime=e},expression:"begintime"}}),t._v("\n\t\t\t\t~\n\t\t\t\t"),i("TimePicker",{staticStyle:{width:"47%"},attrs:{placeholder:"请选择订餐开始时间"},model:{value:t.endtime,callback:function(e){t.endtime=e},expression:"endtime"}})],1),t._v(" "),i("div",{staticClass:"zmiti-admin-setting"},[i("div",[t._v("管理员设置")]),t._v(" "),i("RadioGroup",{model:{value:t.isalluser,callback:function(e){t.isalluser=e},expression:"isalluser"}},[i("Radio",{attrs:{value:0,label:0}},[t._v("全部")]),t._v(" "),i("Radio",{attrs:{value:1,label:1}},[t._v("指定人员")])],1),t._v(" "),1===t.isalluser?i("Select",{attrs:{multiple:""},model:{value:t.users,callback:function(e){t.users=e},expression:"users"}},t._l(t.userList,(function(e,o){return i("Option",{key:o,attrs:{value:e.userid,label:e.realname}},[t._v("\n\t\t\t\t\t\t"+t._s((e.user.realname||e.user.username)+" ( "+e.user.usermobile+" ) ")+"\n\t\t\t\t\t")])})),1):t._e(),t._v(" "),i("div",{staticStyle:{"margin-top":"20px",width:"80%",margin:"20px auto"}},[i("Button",{attrs:{long:"",type:"primary",size:"large"},on:{click:t.setOrderFoodConfigTop}},[t._v("确定")])],1)],1)]),t._v(" "),i("ZmitiMask",{on:{closeMaskPage:t.closeMaskPage}},[i("div",{attrs:{slot:"mask-content"},slot:"mask-content"},[i("section",{staticClass:"zmiti-add-form zmiti-scroll"},[i("header",{staticClass:"zmiti-add-header"},[i("img",{attrs:{src:t.imgs.back,alt:""},on:{click:t.closeMaskPage}}),t._v(" "),i("span",[t._v("今日订餐列表")])]),t._v(" "),i("h2",{staticStyle:{height:"40px"}}),t._v(" "),i("Table",{attrs:{columns:t.columns,data:t.orderFoodDetailData}})],1)])])],1)};c._withStripped=!0;var l=i(3),m=!1;var u=function(t){m||i(692)},f=Object(l.a)(s,c,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("span",{staticClass:"zmt_iconfont"},[this._v("")]),this._v(" 订餐预览表")])},function(){var t=this.$createElement,e=this._self._c||t;return e("header",[e("span",{staticClass:"zmt_iconfont"},[this._v("")]),this._v("\t基础设置\n\t\t\t")])}],!1,u,"data-v-a8c3488c",null);f.options.__file="components\\orderfood\\orderfood\\index.vue";e.default=f.exports}}]);