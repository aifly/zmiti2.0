(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{644:function(t,i,e){var a=e(645);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,e(6).default)("63b14bb4",a,!1,{})},645:function(t,i,e){(t.exports=e(4)()).push([t.i,"\n.zmiti-informanagernews-main-ui[data-v-a5eeb58e]{background:#f2f2f2;box-sizing:border-box;height:100%;width:99%;margin:0 auto\n}\n.zmiti-informanagernews-main-ui .zmiti-list-main[data-v-a5eeb58e]{box-sizing:border-box;background:#fff;margin:0 auto\n}\n.zmiti-informanagernews-main-ui .zmiti-list-where[data-v-a5eeb58e]{font-size:14px;width:98%;margin:0 auto 10px auto;display:flex;display:-webkit-flex;flex-flow:row\n}\n.zmiti-informanagernews-main-ui .zmiti-list-where .zmiti-search-dates[data-v-a5eeb58e]{margin:0 10px\n}\n.zmiti-informanagernews-main-ui .zmiti-search-icon[data-v-a5eeb58e]{font-size:20px;cursor:pointer\n}\n.zmiti-informanagernews-main-ui .zmiti-tabs-select[data-v-a5eeb58e]{width:98%;margin:0 auto\n}\n.zmiti-informanagernews-main-ui .zmiti-submit-main[data-v-a5eeb58e]{margin-top:10px;flex:5;-webkit-flex:5;width:100%\n}\n.zmiti-informanagernews-main-ui .zmiti-submit-main>div[data-v-a5eeb58e]{-webkit-transition:.3s;transition:.3s\n}\n.zmiti-informanagernews-main-ui .zmiti-submit-main .zmiti-submit-table[data-v-a5eeb58e]{width:98%;margin:0 auto\n}\n.zmiti-add-form[data-v-a5eeb58e]{flex:1;-webkit-flex:1;width:500px;overflow:auto;position:absolute !important;top:0;right:0;z-index:100;height:100%;position:relative;box-shadow:0 0 0 1px #ccc;box-sizing:border-box;background:#f9f9f9\n}\n.zmiti-add-form .zmiti-safe-content[data-v-a5eeb58e]{display:flex;display:-webkit-flex;flex-flow:row;-webkit-align-items:center;align-items:center;margin-top:30px;justify-content:space-around;-webkit-justify-content:space-around;border:1px dashed #ccc;padding:10px 0\n}\n.zmiti-add-form .zmiti-safe-content>div[data-v-a5eeb58e]:nth-of-type(1){text-align:center;width:120px;font-weight:bold\n}\n.zmiti-add-form .zmiti-safe-content>div[data-v-a5eeb58e]:nth-of-type(2){flex:1;-webkit-flex:1\n}\n.zmiti-add-form .zmiti-safe-content>div[data-v-a5eeb58e]:nth-of-type(3){width:80px;cursor:pointer;text-align:center;color:#06c\n}\n.zmiti-add-form.detail-enter-active[data-v-a5eeb58e],.zmiti-add-form.detail-leave-active[data-v-a5eeb58e]{-webkit-transition:.2s;transition:.2s\n}\n.zmiti-add-form.detail-enter[data-v-a5eeb58e],.zmiti-add-form.detail-leave-to[data-v-a5eeb58e]{-webkit-transform:translateX(100%);transform:translateX(100%)\n}\n.zmiti-add-form .zmiti-submit-avatar[data-v-a5eeb58e]{background:rgba(51,144,255,0.1);border-radius:50%;text-align:center;width:80px;height:80px;line-height:80px;margin:0 auto 30px;cursor:pointer;position:relative\n}\n.zmiti-add-form .zmiti-submit-avatar label[data-v-a5eeb58e]{position:absolute;bottom:-50px;font-size:12px;width:100%;text-align:center;left:0\n}\n.zmiti-add-form .zmiti-submit-avatar span[data-v-a5eeb58e]{font-size:40px;color:rgba(51,144,255,0.8)\n}\n.zmiti-add-form .zmiti-add-form-C[data-v-a5eeb58e]{margin:10px auto 2px;width:90%\n}\n.zmiti-add-form .zmiti-add-form-item[data-v-a5eeb58e]{line-height:50px;height:50px\n}\n.zmiti-add-form .zmiti-add-form-item.zmiti-add-btns[data-v-a5eeb58e]{text-align:center;position:relative;z-index:10\n}\n.zmiti-add-form .zmiti-add-form-item.zmiti-add-btns button[data-v-a5eeb58e]{margin:0 20px;padding:2px 20px\n}\n.zmiti-add-form .zmiti-add-form-item input[data-v-a5eeb58e]{padding-left:6px;height:32px;width:70%;border:1px solid #d8d8d8;outline:none\n}\n.zmiti-inforuserlist-select ul[data-v-a5eeb58e]{display:flex;display:-webkit-flex;flex-flow:row;flex-wrap:wrap\n}\n.zmiti-inforuserlist-select ul li[data-v-a5eeb58e]{width:120px\n}\n.zmiti-select-column[data-v-a5eeb58e]{padding:10px\n}\n.zmiti-informanagerdetail-form[data-v-a5eeb58e]{padding:20px\n}\n.zmiti-scroll[data-v-a5eeb58e]{overflow:auto\n}\n",""])},646:function(t,i,e){var a=e(647);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,e(6).default)("8fac6b02",a,!1,{})},647:function(t,i,e){(t.exports=e(4)()).push([t.i,"\n.zmiti-informanagernews-main-ui[data-v-ddd568f2]{background:#f2f2f2;box-sizing:border-box;height:100%;width:99%;margin:0 auto\n}\n.zmiti-informanagernews-main-ui .zmiti-list-main[data-v-ddd568f2]{box-sizing:border-box;background:#fff;margin:0 auto\n}\n.zmiti-informanagernews-main-ui .zmiti-list-where[data-v-ddd568f2]{font-size:14px;width:98%;margin:0 auto 10px auto;display:flex;display:-webkit-flex;flex-flow:row\n}\n.zmiti-informanagernews-main-ui .zmiti-list-where .zmiti-search-dates[data-v-ddd568f2]{margin:0 10px\n}\n.zmiti-informanagernews-main-ui .zmiti-search-icon[data-v-ddd568f2]{font-size:20px;cursor:pointer\n}\n.zmiti-informanagernews-main-ui .zmiti-tabs-select[data-v-ddd568f2]{width:98%;margin:0 auto\n}\n.zmiti-informanagernews-main-ui .zmiti-submit-main[data-v-ddd568f2]{margin-top:10px;flex:5;-webkit-flex:5;width:100%\n}\n.zmiti-informanagernews-main-ui .zmiti-submit-main>div[data-v-ddd568f2]{-webkit-transition:.3s;transition:.3s\n}\n.zmiti-informanagernews-main-ui .zmiti-submit-main .zmiti-submit-table[data-v-ddd568f2]{width:98%;margin:0 auto\n}\n.zmiti-add-form[data-v-ddd568f2]{flex:1;-webkit-flex:1;width:500px;overflow:auto;position:absolute !important;top:0;right:0;z-index:100;height:100%;position:relative;box-shadow:0 0 0 1px #ccc;box-sizing:border-box;background:#f9f9f9\n}\n.zmiti-add-form .zmiti-safe-content[data-v-ddd568f2]{display:flex;display:-webkit-flex;flex-flow:row;-webkit-align-items:center;align-items:center;margin-top:30px;justify-content:space-around;-webkit-justify-content:space-around;border:1px dashed #ccc;padding:10px 0\n}\n.zmiti-add-form .zmiti-safe-content>div[data-v-ddd568f2]:nth-of-type(1){text-align:center;width:120px;font-weight:bold\n}\n.zmiti-add-form .zmiti-safe-content>div[data-v-ddd568f2]:nth-of-type(2){flex:1;-webkit-flex:1\n}\n.zmiti-add-form .zmiti-safe-content>div[data-v-ddd568f2]:nth-of-type(3){width:80px;cursor:pointer;text-align:center;color:#06c\n}\n.zmiti-add-form.detail-enter-active[data-v-ddd568f2],.zmiti-add-form.detail-leave-active[data-v-ddd568f2]{-webkit-transition:.2s;transition:.2s\n}\n.zmiti-add-form.detail-enter[data-v-ddd568f2],.zmiti-add-form.detail-leave-to[data-v-ddd568f2]{-webkit-transform:translateX(100%);transform:translateX(100%)\n}\n.zmiti-add-form .zmiti-submit-avatar[data-v-ddd568f2]{background:rgba(51,144,255,0.1);border-radius:50%;text-align:center;width:80px;height:80px;line-height:80px;margin:0 auto 30px;cursor:pointer;position:relative\n}\n.zmiti-add-form .zmiti-submit-avatar label[data-v-ddd568f2]{position:absolute;bottom:-50px;font-size:12px;width:100%;text-align:center;left:0\n}\n.zmiti-add-form .zmiti-submit-avatar span[data-v-ddd568f2]{font-size:40px;color:rgba(51,144,255,0.8)\n}\n.zmiti-add-form .zmiti-add-form-C[data-v-ddd568f2]{margin:10px auto 2px;width:90%\n}\n.zmiti-add-form .zmiti-add-form-item[data-v-ddd568f2]{line-height:50px;height:50px\n}\n.zmiti-add-form .zmiti-add-form-item.zmiti-add-btns[data-v-ddd568f2]{text-align:center;position:relative;z-index:10\n}\n.zmiti-add-form .zmiti-add-form-item.zmiti-add-btns button[data-v-ddd568f2]{margin:0 20px;padding:2px 20px\n}\n.zmiti-add-form .zmiti-add-form-item input[data-v-ddd568f2]{padding-left:6px;height:32px;width:70%;border:1px solid #d8d8d8;outline:none\n}\n.zmiti-inforuserlist-select ul[data-v-ddd568f2]{display:flex;display:-webkit-flex;flex-flow:row;flex-wrap:wrap\n}\n.zmiti-inforuserlist-select ul li[data-v-ddd568f2]{width:120px\n}\n.zmiti-select-column[data-v-ddd568f2]{padding:10px\n}\n.zmiti-informanagerdetail-form[data-v-ddd568f2]{padding:20px\n}\n.zmiti-scroll[data-v-ddd568f2]{overflow:auto\n}\n",""])},727:function(t,i,e){"use strict";e.r(i);var a=e(0),n=e(2),d=e(9),{companyActions:o,zmitiActions:r,infomanagerActions:s,formatDate:l,userActions:m}=n.a,c={props:["productid","columntitle","specialnum"],name:"zmitiindex",data(){return{typename:"",targetKeys:[],showAvatarModal:!1,companyname:"",addDataSource:[],imgs:window.imgs,total:0,loading:!0,currentCityIndex:-1,currentCityId:-1,transX:0,transY:0,viewH:window.innerHeight,viewW:window.innerWidth,dataSource:[],showTable:!1,currentNumber:1,condition:{page_index:0,page_size:10},userinfo:{},typeDataList:[],typeid:-1,title:"",begin_time:0,end_time:0,modal1:!1,data1:this.getMockData(),targetKeys1:[],mockData:[],currUserList:[],statusVal:"-1",selectStatus:[{value:"-1",label:"全部"},{value:"0",label:"禁用"},{value:"1",label:"待审"},{value:"2",label:"通过"},{value:"3",label:"拒绝"}],infoid:-1,companyid:"",userSource:[],columns:[{title:"编号",key:"infoid",align:"center",width:120},{title:"内容",key:"title",align:"center",render:(t,i)=>t("div",{},this.$options.filters.filterFun(i.row.title))},{title:"时间",key:"createtime",align:"center",width:120,render:(t,i)=>t("div",{},l(i.row.createtime))},{title:"操作",key:"action",align:"center",width:120,render:(t,i)=>t("div",[t("span",{style:{cursor:"pointer",color:"rgb(0, 102, 204)",marginRight:"10px"},on:{click:()=>{this.formObj=i.row,this.$router.push({name:"infomanagerlistdetail",params:{productid:this.productid,typeid:this.typeid,id:this.formObj.infoid,typename:this.typename}})}}},"编辑"),t("Poptip",{props:{confirm:!0,title:"确定要删除吗？",placement:"left"},on:{"on-ok":()=>{this.delete(i.row.infoid)}}},[t("span",{props:{type:"error",size:"small"},style:{cursor:"pointer",color:"#06C"},on:{click:()=>{}}},"删除")])])}]}},components:{ZmitiTable:d.a},beforeCreate(){},created(){this.companyid=n.a.getCurrentCompanyId().companyid},mounted(){this.getTypeList(this.specialnum),this.getUserList()},watch:{typeid(){this.getDataList()},statusVal(){this.getDataList()}},methods:{change(t){this.condition.page_index=t-1,this.currentNumber=t,this.getDataList()},add(){this.$router.push({name:"infomanagerlistdetail",params:{productid:this.productid,typeid:this.typeid,typename:this.typename}})},getDataList(){var t=this,{condition:i}=this;i=Object.assign(i,{typeid:t.typeid,productid:t.productid,title:t.title,begin_time:t.begin_time,end_time:t.end_time,status:t.statusVal}),n.a.ajax({remark:"getnewsList",data:{action:s.getnewsList.action,condition:i},error(){t.loading=!1},success(i){t.loading=!1,console.log(i,"获取列表"),0===i.getret?(t.total=i.total,i.total>0?t.dataSource=i.list:t.dataSource=[]):(t.$Message[0===i.getret?"success":"error"](i.msg||i.getmsg),t.dataSource=[])}})},delete(t){var i=this;n.a.ajax({remark:"delnews",data:{action:s.delnews.action,productid:this.productid,infoid:t},success(t){i.$Message[0===t.getret?"success":"error"](t.msg||t.getmsg),i.getDataList()}})},selectDates(t){console.log(t,"选择的时间"),this.begin_time=Date.parse(new Date(t[0]))/1e3,this.end_time=Date.parse(new Date(t[1]))/1e3,console.log(this.begin_time+" "+this.end_time,"选择的时间戳")},searchHandle(){this.getDataList()},getTypeList(t){var{condition:i}=this,e=this;n.a.ajax({remark:"getusertypeinfolist",data:{action:s.getusertypeinfolist.action,condition:{companyid:n.a.getCurrentCompanyId().companyid,specialnum:t,productid:e.productid,page_index:0,page_size:20}},success(t){0===t.getret&&(e.loading=!1,t.total>0&&(e.typeDataList=t.list,e.typeid=t.list[0].infotypeid,e.typename=t.list[0].typename))}})},currentTabs(t){this.typeid=parseInt(t),this.condition.page_index=0,this.currentNumber=1,this.typename=this.typeDataList.filter(i=>i.infotypeid==t).map(t=>t.typename).toString(),console.log(t,"当前标签")},infoStatus(t){this.statusVal=t,this.condition.page_index=0,this.currentNumber=1,console.log(this.statusVal,"选中的状态")},getUserList(){var t=this;n.a.ajax({remark:"getUserList",data:{action:m.getCompanyUserList.action,condition:{page_index:0,page_size:80,companyid:this.companyid,status:1}},success(i){0===i.getret&&i.list.forEach((i,e)=>{t.userSource.push({userid:i.userid,realname:i.user.realname,username:i.user.username})})}})},getMockData(){var t=this;let i=[];return setTimeout(()=>{t.userSource.forEach((t,e)=>{i.push({key:t.userid.toString(),label:t.realname,description:t.username})})},1e3),i},render1:t=>t.label,handleChange1(t,i,e){console.log(t,"newTargetKeys"),console.log(i),console.log(e,"moveKeys"),this.targetKeys1=t;var a=this.infoid;"right"===i?e.forEach((t,i)=>{this.addAccessible(t,a),console.log(t,"添加用户")}):(console.log("移除"),e.forEach((t,i)=>{let e=this.currUserList.filter(i=>i.userid==t).map(t=>t.infovisitid);this.delAccessible(Number(e)),console.log(Number(e)),console.log(t,"删除的用户")}))},getaddAccessibleList(t){var i=this;n.a.ajax({remark:"getaddAccessibleList",data:{action:s.getaddAccessibleList.action,condition:{page_index:0,page_size:50,productid:this.productid,infoid:t}},success(t){0===t.getret&&(console.log(t.list,"获取当前具有权限的用户列表"),t.total>0&&(i.currUserList=t.list,t.list.forEach((t,e)=>{i.targetKeys1.push(t.userid.toString())}),console.log(i.targetKeys1,"获取具有权限的userid")))}})},addAccessible(t,i){n.a.ajax({remark:"addAccessible",data:{action:s.addAccessible.action,info:{userid:Number(t),productid:this.productid,infoid:i}},success(t){t.getret}})},delAccessible(t){n.a.ajax({remark:"delAccessible",data:{action:s.delAccessible.action,info:{productid:this.productid,infovisitid:t}},success(t){0===t.getret&&console.log("获取当前具有权限的用户列表")}})},ok(){this.targetKeys1=[]},cancel(){this.targetKeys1=[]}},filters:{msg:function(t){return t.replace(/<[^<>]+>/g,"")},filterFun:function(t){return t&&t.length>25&&(t=t.substring(0,25)+"..."),t}}},p=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"zmiti-informanagernews-main-ui"},[e("div",{staticClass:"zmiti-list-main"},[e("div",{staticClass:"zmiti-informanagernews-table lt-full"},[e("header",{staticClass:"zmiti-tab-header"},[e("div",[e("span",[t._v(t._s(t.columntitle))])]),t._v(" "),e("div",[e("Button",{attrs:{type:"primary"},on:{click:function(i){return t.add()}}},[t._v("添加")])],1)]),t._v(" "),e("div",{staticClass:"zmiti-submit-main zmiti-scroll",style:{height:t.viewH-110+"px"}},[e("div",{staticClass:"zmiti-tabs-select"},[e("Tabs",{on:{"on-click":t.currentTabs}},t._l(t.typeDataList,(function(t,i){return e("TabPane",{key:i,attrs:{label:t.typename,name:t.infotypeid.toString()}})})),1)],1),t._v(" "),e("section",{staticClass:"zmiti-list-where"},[e("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入内容"},model:{value:t.title,callback:function(i){t.title=i},expression:"title"}}),t._v(" "),e("div",{staticClass:"zmiti-search-dates"},[e("DatePicker",{staticStyle:{width:"200px"},attrs:{type:"daterange","start-date":new Date(2018,12,1),placement:"bottom-end",placeholder:"选择时间段"},on:{"on-change":t.selectDates}})],1),t._v(" "),e("Button",{attrs:{icon:"md-search"},on:{click:t.searchHandle}},[t._v("搜索")])],1),t._v(" "),e("ZmitiTable",{attrs:{loading:t.loading,dataSource:t.dataSource,columns:t.columns,current:t.currentNumber,change:t.change,"page-size":t.condition.page_size,total:t.total}})],1)])]),t._v(" "),e("Modal",{attrs:{title:"访问人员列表",width:"470"},on:{"on-ok":t.ok,"on-cancel":t.cancel},model:{value:t.modal1,callback:function(i){t.modal1=i},expression:"modal1"}},[e("Transfer",{attrs:{titles:["普通用户","可访问用户"],data:t.data1,"target-keys":t.targetKeys1,"render-format":t.render1},on:{"on-change":t.handleChange1}}),t._v(" "),e("div",{attrs:{slot:"footer"},slot:"footer"})],1)],1)};p._withStripped=!0;var u=e(3),f=!1;var g=function(t){f||e(646)},h=Object(u.a)(c,p,[],!1,g,"data-v-ddd568f2",null);h.options.__file="components\\infomanager\\list\\list.vue";var b=h.exports,{companyActions:v,zmitiActions:x,infomanagerActions:w,formatDate:z,userActions:y}=n.a,k={props:["obserable"],name:"zmitiindex",data:()=>({targetKeys:[],showAvatarModal:!1,companyname:"",addDataSource:[],imgs:window.imgs,total:0,loading:!0,currentCityIndex:-1,currentCityId:-1,transX:0,transY:0,viewH:window.innerHeight,viewW:window.innerWidth,dataSource:[],showTable:!1,currentNumber:1,condition:{page_index:0,page_size:10},userinfo:{},typeDataList:[],typeid:-1,productid:0,showTemplate:!1,title:"",begin_time:0,end_time:0,modal1:!1,targetKeys1:[],mockData:[],currUserList:[],statusVal:"-1",selectStatus:[{value:"-1",label:"全部"},{value:"0",label:"禁用"},{value:"1",label:"待审"},{value:"2",label:"通过"},{value:"3",label:"拒绝"}],infoid:-1,companyid:"",userSource:[]}),components:{ZmitiTable:d.a,IninforManager:b},beforeCreate(){},created(){this.companyid=n.a.getCurrentCompanyId().companyid},mounted(){this.init(()=>{})},watch:{$route:{handler(){var t=this.productid;t&&this.$router.push({path:"/infomanagerlist/"+t})}},productid(){this.showTemplate=!0}},methods:{init(t){var i=this,e=setInterval(()=>{if(a.default.productList){clearInterval(e);var n=this.$route.params.id;n||a.default.productList.forEach(t=>{i.$route.name.indexOf(t.producturl.substr(1))>-1&&(n=t.productid)}),this.$router.push({path:"/infomanagerlist/"+n}),this.productid=n,t&&t(n)}},100)}}},_=function(){var t=this.$createElement,i=this._self._c||t;return i("div",[1==this.showTemplate?[i("ininfor-manager",{attrs:{productid:this.productid,columntitle:"公告",specialnum:"3"}})]:this._e()],2)};_._withStripped=!0;var L=!1;var D=function(t){L||e(644)},C=Object(u.a)(k,_,[],!1,D,"data-v-a5eeb58e",null);C.options.__file="components\\infomanager\\list\\index.vue";i.default=C.exports}}]);