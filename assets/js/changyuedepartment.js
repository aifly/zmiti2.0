(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{607:function(t,a,e){var i=e(608);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,e(6).default)("671c806d",i,!1,{})},608:function(t,a,e){(t.exports=e(4)()).push([t.i,'\n.zmiti-user-main-ui[data-v-a136b7f8]{background:#f2f2f2;box-sizing:border-box;height:100%;width:99%;margin:0 auto\n}\n.zmiti-user-main-ui .zmiti-avatar-list[data-v-a136b7f8]{display:flex;display:-webkit-flex;flex-flow:row\n}\n.zmiti-user-main-ui .zmiti-avatar-list span[data-v-a136b7f8]{font-size:40px;margin-right:20px;cursor:pointer\n}\n.zmiti-user-main-ui .zmiti-avatar-list span.active[data-v-a136b7f8]{color:#3390ff\n}\n.zmiti-user-main-ui .ivu-table-wrapper[data-v-a136b7f8]{border-bottom:none;border-right:none\n}\n.zmiti-user-main-ui .zmiti-list-main[data-v-a136b7f8]{box-sizing:border-box;background:#fff;margin:0 auto;flex:2;-webkit-flex:2;position:relative;top:5px;display:flex;display:-webkit-flex;flex-flow:column\n}\n.zmiti-user-main-ui .zmiti-list-main[data-v-a136b7f8]:before{content:"";position:absolute;width:100%;height:100%;left:0;top:0;box-shadow:0 0 0 1px #ccc\n}\n.zmiti-user-main-ui .zmiti-list-main .zmiti-add-form-close[data-v-a136b7f8]{z-index:100\n}\n.zmiti-user-main-ui .zmiti-list-main>div[data-v-a136b7f8]{margin:10px auto 10px;position:relative;flex:1;-webkit-flex:1\n}\n.zmiti-user-main-ui .zmiti-list-main>div .zmiti-meet-form[data-v-a136b7f8]{width:100%;margin:0px auto;padding:20px 40px;height:600px;overflow:auto\n}\n.zmiti-user-main-ui .zmiti-list-main .zmiti-list-where[data-v-a136b7f8]{width:98%;margin:10px auto 0;height:40px;line-height:40px;font-size:14px;position:relative;z-index:10\n}\n.zmiti-user-main-ui .zmiti-list-main .zmiti-list-where input[data-v-a136b7f8]{height:30px\n}\n.zmiti-user-main-ui .zmiti-list-main .zmiti-user-main[data-v-a136b7f8]{flex:5;-webkit-flex:5;width:100%\n}\n.zmiti-user-main-ui .zmiti-list-main .zmiti-user-main>div[data-v-a136b7f8]{-webkit-transition:.3s;transition:.3s\n}\n.zmiti-user-main-ui .lt-full[data-v-a136b7f8]{position:fixed !important;background:rgba(0,0,0,0.5);z-index:1001;overflow:hidden\n}\n.zmiti-user-main-ui .lt-full .zmiti-left-pannel[data-v-a136b7f8]{position:absolute;width:100%;height:100px;left:0;top:0;z-index:10\n}\n.zmiti-add-form[data-v-a136b7f8]{flex:1;-webkit-flex:1;width:500px;overflow:auto;position:absolute !important;top:0;right:0;z-index:100;height:100%;position:relative;box-shadow:0 0 0 1px #ccc;box-sizing:border-box;background:#f9f9f9\n}\n.zmiti-add-form .zmiti-safe-content[data-v-a136b7f8]{display:flex;display:-webkit-flex;flex-flow:row;-webkit-align-items:center;align-items:center;margin-top:30px;justify-content:space-around;-webkit-justify-content:space-around;border:1px dashed #ccc;padding:10px 0\n}\n.zmiti-add-form .zmiti-safe-content>div[data-v-a136b7f8]:nth-of-type(1){text-align:center;width:120px;font-weight:bold\n}\n.zmiti-add-form .zmiti-safe-content>div[data-v-a136b7f8]:nth-of-type(2){flex:1;-webkit-flex:1\n}\n.zmiti-add-form .zmiti-safe-content>div[data-v-a136b7f8]:nth-of-type(3){width:80px;cursor:pointer;text-align:center;color:#06c\n}\n.zmiti-add-form.detail-enter-active[data-v-a136b7f8],.zmiti-add-form.detail-leave-active[data-v-a136b7f8]{-webkit-transition:.2s;transition:.2s\n}\n.zmiti-add-form.detail-enter[data-v-a136b7f8],.zmiti-add-form.detail-leave-to[data-v-a136b7f8]{-webkit-transform:translateX(100%);transform:translateX(100%)\n}\n.zmiti-add-form .zmiti-user-avatar[data-v-a136b7f8]{background:rgba(51,144,255,0.1);border-radius:50%;text-align:center;width:80px;height:80px;line-height:80px;margin:0 auto 30px;cursor:pointer;position:relative\n}\n.zmiti-add-form .zmiti-user-avatar label[data-v-a136b7f8]{position:absolute;bottom:-50px;font-size:12px;width:100%;text-align:center;left:0\n}\n.zmiti-add-form .zmiti-user-avatar span[data-v-a136b7f8]{font-size:40px;color:rgba(51,144,255,0.8)\n}\n.zmiti-add-form .zmiti-add-form-C[data-v-a136b7f8]{margin:10px auto 2px;width:90%\n}\n.zmiti-add-form .zmiti-add-form-item[data-v-a136b7f8]{line-height:50px;height:50px\n}\n.zmiti-add-form .zmiti-add-form-item.zmiti-add-btns[data-v-a136b7f8]{text-align:center;position:relative;z-index:10\n}\n.zmiti-add-form .zmiti-add-form-item.zmiti-add-btns button[data-v-a136b7f8]{margin:0 20px;padding:2px 20px\n}\n.zmiti-add-form .zmiti-add-form-item input[data-v-a136b7f8]{padding-left:6px;height:32px;width:70%;border:1px solid #d8d8d8;outline:none\n}\n.ivu-icon-ios-help-circle[data-v-a136b7f8]{left:25px\n}\n.ivu-radio-inner[data-v-a136b7f8]:after{border-radius:10px !important\n}\n',""])},62:function(t,a,e){var i=e(63);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,e(6).default)("03927da0",i,!1,{})},63:function(t,a,e){(t.exports=e(4)()).push([t.i,"\n.zmiti-avatar-list[data-v-e6b7be7c]{display:flex;display:-webkit-flex;flex-flow:row\n}\n.zmiti-avatar-list span[data-v-e6b7be7c]{font-size:40px;margin-right:20px;cursor:pointer\n}\n.zmiti-avatar-list span.active[data-v-e6b7be7c]{color:#3390ff\n}\n",""])},65:function(t,a,e){"use strict";var i={props:{value:{type:Boolean},avatar:{type:String,default:""}},watch:{value(t){t||(this.chooseAvatar(),this.show=!1),this.show=t}},methods:{chooseAvatar(){this.$emit("getAvatar",this.avatarList[this.index]),this.$emit("input",!1)},closeModal(t){t||(this.chooseAvatar(),this.show=!1),this.show=t}},data:()=>({show:!0,index:-1,avatarList:["&#xe6a5;","&#xe6a4;","&#xe6a3;","&#xe6a2;","&#xe6a0;","&#xe661;"]}),mounted(){this.avatarList.forEach((t,a)=>{t===this.avatar&&(this.index=a)})}},n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return t.value?e("div",[e("Modal",{attrs:{title:"更换头像",transfer:!0,"mask-closable":!1},on:{"on-visible-change":t.closeModal},model:{value:t.show,callback:function(a){t.show=a},expression:"show"}},[e("div",{attrs:{slot:"footer"},slot:"footer"},[e("Button",{attrs:{type:"primary"},on:{click:t.chooseAvatar}},[t._v("确定")])],1),t._v(" "),e("div",{staticClass:"zmiti-avatar-list"},t._l(t.avatarList,(function(a,i){return e("span",{key:i,staticClass:"zmt_iconfont",class:{active:t.index===i},domProps:{innerHTML:t._s(a)},on:{click:function(a){t.index=i}}})})),0)])],1):t._e()};n._withStripped=!0;var r=e(3),s=!1;var o=function(t){s||e(62)},d=Object(r.a)(i,n,[],!1,o,"data-v-e6b7be7c",null);d.options.__file="common\\avatar\\index.vue";a.a=d.exports},756:function(t,a,e){"use strict";e.r(a);var i=e(0),n=e(2),r=e(65),s=e(10),o=e(9),{companyActions:d,zmitiActions:l,companyAdminActions:m,formatDate:c,userActions:p}=n.a,u={props:["obserable"],name:"zmitiindex",data(){return{targetKeys:[],showAvatarModal:!1,visible:!1,total:0,avatarList:["&#xe6a5;","&#xe6a4;","&#xe6a3;","&#xe6a2;","&#xe6a0;"],companyname:"",roleList:[],imgs:window.imgs,isLoading:!1,showDetail:!1,loading:!0,showDetailPage:-1,currentClassId:-1,adminuserId:"",currentUserid:"",formObj:{isover:0,usersign:1,usertypesign:1,avatar:"&#xe6a4;"},address:"",showPass:!1,showMap:!1,viewH:window.innerHeight,viewW:window.innerWidth,dataSource:[],groupList:[],departmentList:[],hideMenu:!1,unJoinedDepartment:[],columns:[{title:"角色编号",key:"departmentid",align:"center"},{title:"角色名称",key:"departmentname",align:"center",width:200},{title:"创建时间",key:"createtime",align:"center",render:(t,a)=>t("div",{},c(a.row.createtime))},{title:"状态",key:"status",align:"center",render:(t,a)=>t("div",{},1===a.row.status?"正常使用":0===a.row.status?"已禁用":"已删除")},{title:"操作",key:"action",align:"center",width:200,render:(t,a)=>t("div",[t("span",{props:{type:"primary",size:"small"},style:{margin:"2px 10px",border:"none",fontSize:"12px",cursor:"pointer",color:"#06C"},on:{click:()=>{this.visible=!0,this.getJoinedDepartment(a.row.departmentid),this.currentDepartmentId=a.row.departmentid}}},"用户管理"),t("span",{props:{type:"primary",size:"small"},style:{margin:"2px 10px",border:"none",fontSize:"12px",cursor:"pointer",color:"#06C"},on:{click:()=>{var t=this;t.showDetail=!0,i.default.obserable.trigger({type:"toggleMask",data:!0}),t.formObj=a.row,t.showDetailPage=1}}},"编辑"),t("Poptip",{props:{confirm:!0,title:"确定要删除吗？",placement:"left"},on:{"on-ok":()=>{this.delete(a.row.departmentid)}}},[t("span",{props:{type:"error",size:"small"},style:{cursor:"pointer",color:"#06C"},on:{click:()=>{}}},"删除")])])}],formObj:{pdfurl:"",longitude:"116.585856",latitude:"40.364989"},directoryList:{},condition:{page_index:0,page_size:10},userinfo:{}}},components:{Avatar:r.a,ZmitiMask:s.a,ZmitiTable:o.a},beforeCreate(){},mounted(){window.s=this,this.getDataList(),i.default[this.$route.name]=()=>{this.getDataList()}},watch:{showDetail(t){t?this.showDetailPage=1:setTimeout(()=>{this.showDetailPage=-1},310)},$route:{handler(){var t=this.productid;t&&this.$router.push({path:"/changyuedepartment/"+t})}}},methods:{change(t){this.condition.page_index=t-1,this.getDataList()},getSelection(t){this.selectList=t},selectionDelete(){if(this.selectList.length<=0)this.$Message.error({content:"您还未选择任何要删除的项",duration:5});else{var t=this.selectList.map(t=>t.departmentid).join(",");this.delete(t)}},closeMaskPage(){this.showDetailPage=-1},handleChange2(t,a,e){var i=this,r="left"===a?"condition":"info";n.a.ajax({remark:"left"===a?"delDepartmentUser":"addDepartmentUser",data:{action:p["left"===a?"delDepartmentUser":"addDepartmentUser"].action,[r]:{companyid:n.a.getCurrentCompanyId().companyid,productid:i.$route.params.id,departmentid:i.currentDepartmentId,userids:e.join(",")}},success(t){i.$Message[0===t.getret?"success":"error"](t.msg),i.getJoinedDepartment(i.currentDepartmentId)}})},filterMethod:(t,a)=>t.label.indexOf(a)>-1,getJoinedDepartment(t){var a=this;n.a.ajax({remark:"getDepartmentUserList",data:{action:p.getDepartmentUserList.action,condition:{page_index:0,page_size:100,companyid:n.a.getCurrentCompanyId().companyid,productid:a.$route.params.id,departmentid:t}},success(t){0===t.getret&&(a.targetKeys=[],t.list.forEach(t=>{a.targetKeys.push(t.userid)}))}})},getAllUserList(t){var a=this;n.a.ajax({remark:"getAllCompanyUserList",data:{action:p.getAllCompanyUserList.action,condition:{page_index:0,page_size:100,companyid:n.a.getCurrentCompanyId().companyid,productid:t||a.$route.params.id}},success(t){0===t.getret&&(a.departmentList=t.list,a.unJoinedDepartment=[],a.departmentList.forEach(t=>{a.unJoinedDepartment.push({key:t.userid,label:t.realname,description:t.realname})}))}})},checkUser(){var t=this.formObj.username,{$Message:a}=this;n.a.adminAjax({remark:"checkUserName",data:{action:l.checkUserName.action,username:t},success(t){a[0===t.getret?t.used?"error":"success":"error"](t.msg)}})},getAvatar(t){this.formObj.avatar=t},addAdmin(){this.showDetail=!0,this.adminuserId="",this.formObj={isover:0,avatar:"&#xe6a4;"},this.showDetailPage=1,i.default.obserable.trigger({type:"toggleMask",data:!0})},delete(t){var a=this;n.a.ajax({remark:"delDepartment",data:{action:m.delDepartment.action,info:{departmentids:t}},success(t){a.$Message[0===t.getret?"success":"error"](t.msg),0===t.getret&&a.getDataList()}})},getDataList(){var t=this;if(this.loading=!0,"function"==typeof window.Promise){var a=n.a.getCurrentCompanyId().companyid;this.condition.companyid=a;var e=setInterval(()=>{var a=this.$route.params.id;if(i.default.productList){clearInterval(e),a||i.default.productList.forEach(e=>{t.$route.name.indexOf(e.producturl.substr(1))>-1&&(a=e.productid)}),this.getAllUserList(a);var{condition:r}=this;r=Object.assign(r,{companyid:n.a.getCurrentCompanyId().companyid,productid:a}),this.$router.push({path:"/changyuedepartment/"+a}),this.productid=a;new Promise((a,e)=>{n.a.ajax({remark:"getDepartmentList",data:{action:m.getDepartmentList.action,condition:this.condition},success(e){t.loading=!1,0===e.getret&&(t.dataSource=e.list,t.total=e.total||e.list.length,a())}})})}},100)}else console.log("当前浏览器不支持Promise")},adminAction(){var t=this,a=this.formObj.departmentid?m.editDepartment.action:m.addDepartment.action,e={departmentname:this.formObj.departmentname,status:this.formObj.status,companyid:n.a.getCurrentCompanyId().companyid};this.formObj.departmentid&&(e.departmentid=this.formObj.departmentid),n.a.ajax({remark:this.formObj.action?"editDepartment":"addDepartment",data:{action:a,info:e},success(a){t.$Message[0===a.getret?"success":"error"](a.msg),0===a.getret&&(t.showDetail=!1,t.getDataList())}})}}},f=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"zmiti-user-main-ui"},[e("div",{staticClass:"zmiti-list-main"},[e("header",{staticClass:"zmiti-tab-header"},[e("div",[t.companyname?e("span",[t._v(t._s(t.companyname)+" —— ")]):t._e(),t._v("畅阅-角色管理")]),t._v(" "),e("div",[e("Button",{attrs:{type:"primary"},on:{click:t.addAdmin}},[t._v("添加角色")]),t._v(" "),e("Button",{attrs:{type:"primary",loading:t.loading},on:{click:t.getDataList}},[t._v("刷新")])],1)]),t._v(" "),t._m(0),t._v(" "),e("div",{staticClass:"zmiti-user-main zmiti-scroll ",style:{height:t.viewH-180+"px"}},[e("ZmitiTable",{attrs:{loading:t.loading,dataSource:t.dataSource,columns:t.columns,change:t.change,"page-size":t.condition.page_size,total:t.total},on:{getSelection:t.getSelection}},[e("div",{staticStyle:{display:"inline-block"},attrs:{slot:"table-btns"},slot:"table-btns"},[e("Poptip",{attrs:{confirm:"",title:"确定要删除吗?"},on:{"on-ok":t.selectionDelete}},[e("div",{staticClass:"zmiti-table-btn"},[t._v("删除")])]),t._v(" "),e("div",{staticClass:"zmiti-table-btn"},[t._v("禁用")])],1)])],1),t._v(" "),(t.showDetail,t._e())]),t._v(" "),e("ZmitiMask",{on:{closeMaskPage:t.closeMaskPage},model:{value:t.showDetailPage,callback:function(a){t.showDetailPage=a},expression:"showDetailPage"}},[e("div",{attrs:{slot:"mask-content",name:"detail"},slot:"mask-content"},[e("section",{staticClass:"zmiti-add-form zmiti-scroll"},[e("header",{staticClass:"zmiti-add-header"},[e("img",{attrs:{src:t.imgs.back,alt:""},on:{click:function(a){t.showDetail=!1}}}),t._v(" "),e("span",[t._v("基础信息")])]),t._v(" "),e("h1",{staticStyle:{height:"60px"}}),t._v(" "),e("Form",{staticClass:"zmiti-add-form-C",attrs:{model:t.formObj,"label-width":120}},[e("FormItem",{attrs:{label:"角色名称："}},[e("Input",{attrs:{placeholder:"角色名称："},model:{value:t.formObj.departmentname,callback:function(a){t.$set(t.formObj,"departmentname",a)},expression:"formObj.departmentname"}})],1),t._v(" "),e("FormItem",{attrs:{label:"状态："}},[e("RadioGroup",{model:{value:t.formObj.status,callback:function(a){t.$set(t.formObj,"status",a)},expression:"formObj.status"}},[e("Radio",{attrs:{value:0,label:0}},[t._v("禁用")]),t._v(" "),e("Radio",{attrs:{value:1,label:1}},[t._v("正常使用")])],1)],1)],1),t._v(" "),e("div",{staticClass:"zmiti-add-form-item zmiti-add-btns"},[e("Button",{attrs:{size:"large",type:"primary"},on:{click:t.adminAction}},[t._v(t._s(t.formObj.departmentid?"保存":"确定"))])],1)],1)])]),t._v(" "),e("Modal",{attrs:{title:"加入单位",width:"457"},model:{value:t.visible,callback:function(a){t.visible=a},expression:"visible"}},[e("div",[e("Transfer",{attrs:{data:t.unJoinedDepartment,titles:["用户列表","当前角色下的用户"],"target-keys":t.targetKeys,filterable:"","filter-method":t.filterMethod},on:{"on-change":t.handleChange2}})],1)]),t._v(" "),e("Avatar",{attrs:{avatar:t.formObj.avatar},on:{getAvatar:t.getAvatar},model:{value:t.showAvatarModal,callback:function(a){t.showAvatarModal=a},expression:"showAvatarModal"}})],1)};f._withStripped=!0;var h=e(3),v=!1;var g=function(t){v||e(607)},b=Object(h.a)(u,f,[function(){var t=this.$createElement,a=this._self._c||t;return a("section",{staticClass:"zmiti-list-where"},[this._v("\n\t\t\t用户编号 "),a("input",{attrs:{type:"text"}})])}],!1,g,"data-v-a136b7f8",null);b.options.__file="components\\changyuedepartment\\index.vue";a.default=b.exports}}]);