(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{680:function(t,e,i){var a=i(681);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i(6).default)("85eae4ea",a,!1,{})},681:function(t,e,i){(t.exports=i(4)()).push([t.i,"\n.zmiti-votemanager-main-ui[data-v-2cbac992]{background:#f2f2f2;box-sizing:border-box;height:100%;width:99%;margin:0 auto\n}\n.zmiti-votemanager-main-ui .zmiti-list-main[data-v-2cbac992]{box-sizing:border-box;background:#fff;margin:0 auto\n}\n.zmiti-votemanager-main-ui .zmiti-submit-main[data-v-2cbac992]{flex:5;-webkit-flex:5;width:100%\n}\n.zmiti-votemanager-main-ui .zmiti-submit-main>div[data-v-2cbac992]{-webkit-transition:.3s;transition:.3s\n}\n.zmiti-votemanager-main-ui .zmiti-submit-main .zmiti-submit-table[data-v-2cbac992]{width:98%;margin:0 auto\n}\n.zmiti-add-form[data-v-2cbac992]{flex:1;-webkit-flex:1;width:500px;overflow:auto;position:absolute !important;top:0;right:0;z-index:100;height:100%;position:relative;box-shadow:0 0 0 1px #ccc;box-sizing:border-box;background:#f9f9f9\n}\n.zmiti-add-form .zmiti-safe-content[data-v-2cbac992]{display:flex;display:-webkit-flex;flex-flow:row;-webkit-align-items:center;align-items:center;margin-top:30px;justify-content:space-around;-webkit-justify-content:space-around;border:1px dashed #ccc;padding:10px 0\n}\n.zmiti-add-form .zmiti-safe-content>div[data-v-2cbac992]:nth-of-type(1){text-align:center;width:120px;font-weight:bold\n}\n.zmiti-add-form .zmiti-safe-content>div[data-v-2cbac992]:nth-of-type(2){flex:1;-webkit-flex:1\n}\n.zmiti-add-form .zmiti-safe-content>div[data-v-2cbac992]:nth-of-type(3){width:80px;cursor:pointer;text-align:center;color:#06c\n}\n.zmiti-add-form.detail-enter-active[data-v-2cbac992],.zmiti-add-form.detail-leave-active[data-v-2cbac992]{-webkit-transition:.2s;transition:.2s\n}\n.zmiti-add-form.detail-enter[data-v-2cbac992],.zmiti-add-form.detail-leave-to[data-v-2cbac992]{-webkit-transform:translateX(100%);transform:translateX(100%)\n}\n.zmiti-add-form .zmiti-submit-avatar[data-v-2cbac992]{background:rgba(51,144,255,0.1);border-radius:50%;text-align:center;width:80px;height:80px;line-height:80px;margin:0 auto 30px;cursor:pointer;position:relative\n}\n.zmiti-add-form .zmiti-submit-avatar label[data-v-2cbac992]{position:absolute;bottom:-50px;font-size:12px;width:100%;text-align:center;left:0\n}\n.zmiti-add-form .zmiti-submit-avatar span[data-v-2cbac992]{font-size:40px;color:rgba(51,144,255,0.8)\n}\n.zmiti-add-form .zmiti-add-form-C[data-v-2cbac992]{margin:10px auto 2px;width:90%\n}\n.zmiti-add-form .zmiti-add-form-item[data-v-2cbac992]{line-height:50px;height:50px\n}\n.zmiti-add-form .zmiti-add-form-item.zmiti-add-btns[data-v-2cbac992]{text-align:center;position:relative;z-index:10\n}\n.zmiti-add-form .zmiti-add-form-item.zmiti-add-btns button[data-v-2cbac992]{margin:0 20px;padding:2px 20px\n}\n.zmiti-add-form .zmiti-add-form-item input[data-v-2cbac992]{padding-left:6px;height:32px;width:70%;border:1px solid #d8d8d8;outline:none\n}\n.zmiti-inforuserlist-select ul[data-v-2cbac992]{display:flex;display:-webkit-flex;flex-flow:row;flex-wrap:wrap\n}\n.zmiti-inforuserlist-select ul li[data-v-2cbac992]{width:120px\n}\n.zmiti-select-column[data-v-2cbac992]{padding:10px\n}\n.zmiti-transfer-userlist[data-v-2cbac992]{width:435px;margin:0 auto\n}\n",""])},785:function(t,e,i){"use strict";i.r(e);var a=i(0),o=i(2),n=i(9),r=i(10),{companyActions:s,zmitiActions:d,infomanagerActions:m,formatDate:c,userActions:l,voteActions:p}=o.a,g={props:["obserable"],name:"zmitiindex",data(){return{companyid:"",companyname:"",votetitle:"",imgs:window.imgs,total:0,loading:!0,viewH:window.innerHeight,viewW:window.innerWidth,showDetailPage:-1,dataSource:[],showTable:!1,currentNumber:1,condition:{page_index:0,page_size:10},userinfo:{},productid:0,voteid:void 0,begintime:"2019-01-01",endtime:"2019-01-01",formObj:{votetitle:"",isrealname:0,begintime:"2019-01-01",endtime:"2019-01-01"},columns:[{title:"编号",key:"voteid",align:"center",width:100},{title:"投票标题",key:"votetitle",align:"center"},{title:"投票时间",key:"begintime",align:"center",width:180,render:(t,e)=>t("div",{},this.timestampToTime(e.row.begintime)+"~~"+this.timestampToTime(e.row.endtime))},{title:"匿名",key:"isrealname",align:"center",width:100,render:(t,e)=>{const i=[t("span",{style:{color:"#ff0000"}},"是")];return t("div",{},1==e.row.isrealname?i:"否")}},{title:"操作",key:"action",align:"center",width:250,render:(t,e)=>t("div",[t("span",{style:{cursor:"pointer",color:"rgb(0, 102, 204)",marginLeft:"10px"},on:{click:()=>{this.formObj=e.row,this.begintime=this.timestampToTime(e.row.begintime),this.endtime=this.timestampToTime(e.row.endtime),this.voteid=e.row.voteid,a.default.obserable.trigger({type:"toggleMask",data:!0})}}},"编辑"),t("span",{style:{cursor:"pointer",color:"rgb(0, 102, 204)",marginLeft:"10px"},on:{click:()=>{this.$router.push({name:"votemanagerview",params:{id:this.productid,voteid:e.row.voteid}})}}},"投票项管理"),t("span",{style:{cursor:"pointer",color:"rgb(0, 102, 204)",marginLeft:"10px",marginRight:"10px"},on:{click:()=>{this.$router.push({name:"votemanagerviewcount",params:{id:this.productid,voteid:e.row.voteid}})}}},"投票结果"),t("Poptip",{props:{confirm:!0,title:"确定要删除吗？",placement:"left"},on:{"on-ok":()=>{this.delete(e.row.infotypeid)}}},[t("span",{props:{type:"error",size:"small"},style:{cursor:"pointer",color:"#06C"},on:{click:()=>{}}},"删除")])])}]}},components:{ZmitiMask:r.a,ZmitiTable:n.a},beforeCreate(){},created(){this.companyid=o.a.getCurrentCompanyId().companyid},mounted(){this.init(()=>{setTimeout(()=>{this.getDataList()},100)})},computed:{},watch:{$route:{handler(){var t=this.productid;t&&this.$router.push({path:"/votemanager/"+t})}}},methods:{init(t){var e=this,i=setInterval(()=>{if(a.default.productList){clearInterval(i);var o=this.$route.params.id;o||a.default.productList.forEach(t=>{e.$route.name.indexOf(t.producturl.substr(1))>-1&&(o=t.productid)}),this.$router.push({path:"/votemanager/"+o}),this.productid=o,t&&t(o)}},100)},change(t){this.condition.page_index=t-1,this.currentNumber=t,this.getDataList()},getDataList(){console.log(p,"voteActions==voteActions");var{condition:t}=this,e=this;t=Object.assign(t,{companyid:o.a.getCurrentCompanyId().companyid,productid:e.productid,votetitle:e.votetitle}),o.a.ajax({remark:"getVoteList",data:{action:p.getVoteList.action,condition:t},error(){e.loading=!1},success(t){e.loading=!1,console.log(t,"获取列表"),e.dataSource=t.list}})},closeMaskPage(){console.log("关闭右侧"),a.default.obserable.trigger({type:"toggleMask",data:!1})},selectDatesBegin(t){this.begintime=t},selectDatesEnd(t){this.endtime=t},add(){this.formObj={},this.formObj.isrealname="0",this.voteid=void 0,console.log(this.formObj,"this.formObj"),a.default.obserable.trigger({type:"toggleMask",data:!0})},adminAction(){var t=this,e=this.voteid?p.editVote.action:p.addVote.action;let i={votetitle:this.formObj.votetitle,companyid:this.companyid,productid:this.productid,isrealname:this.formObj.isrealname,begintime:Date.parse(new Date(t.begintime))/1e3,endtime:Date.parse(new Date(t.endtime))/1e3,abstract:this.formObj.abstract};null!=t.voteid&&(i.voteid=t.voteid),console.log(i,"info-info"),o.a.ajax({remark:this.voteid?"editVote":"addVote",data:{action:e,info:i},success(e){t.$Message[0===e.getret?"success":"error"](e.msg||e.getmsg),t.closeMaskPage(),0===e.getret&&t.getDataList()}})},delete(t){console.log(t,"voteid");var e=this;o.a.ajax({remark:"deltypeList",data:{action:p.deleteVote.action,voteid:t,productid:e.productid},success(t){e.$Message[0===t.getret?"success":"error"](t.msg||t.getmsg),e.getDataList()}})},timestampToTime(t){var e=new Date(1e3*t);return e.getFullYear()+"-"+((e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-")+(e.getDate()+1<10?"0"+e.getDate():e.getDate())}}},b=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"zmiti-votemanager-main-ui"},[i("div",{staticClass:"zmiti-list-main"},[i("div",{staticClass:"zmiti-informanager-table lt-full"},[i("header",{staticClass:"zmiti-tab-header"},[t._m(0),t._v(" "),i("div",[i("Button",{attrs:{type:"primary"},on:{click:function(e){return t.add()}}},[t._v("添加")])],1)]),t._v(" "),i("div",{staticClass:"zmiti-submit-main zmiti-scroll",style:{height:t.viewH-110+"px"}},[i("ZmitiTable",{attrs:{loading:t.loading,dataSource:t.dataSource,columns:t.columns,current:t.currentNumber,change:t.change,"page-size":t.condition.page_size,total:t.total}})],1)])]),t._v(" "),i("ZmitiMask",{on:{closeMaskPage:t.closeMaskPage},model:{value:t.showDetailPage,callback:function(e){t.showDetailPage=e},expression:"showDetailPage"}},[i("div",{attrs:{slot:"mask-content"},slot:"mask-content"},[i("transition",{attrs:{name:"detail"}},[i("section",{staticClass:"zmiti-add-form zmiti-scroll"},[i("header",{staticClass:"zmiti-add-header"},[i("img",{attrs:{src:t.imgs.back,alt:""},on:{click:t.closeMaskPage}}),t._v(" "),i("span",[t._v("基础信息")])]),t._v(" "),i("Form",{staticClass:"zmiti-add-form-C",attrs:{model:t.formObj,"label-width":80}},[i("FormItem",{attrs:{label:"投票标题："}},[i("Input",{attrs:{placeholder:"投票标题"},model:{value:t.formObj.votetitle,callback:function(e){t.$set(t.formObj,"votetitle",e)},expression:"formObj.votetitle"}})],1),t._v(" "),i("FormItem",{attrs:{label:"摘要："}},[i("Input",{attrs:{type:"textarea",placeholder:"摘要"},model:{value:t.formObj.abstract,callback:function(e){t.$set(t.formObj,"abstract",e)},expression:"formObj.abstract"}})],1),t._v(" "),i("FormItem",{attrs:{label:"实名："}},[i("RadioGroup",{model:{value:t.formObj.isrealname,callback:function(e){t.$set(t.formObj,"isrealname",e)},expression:"formObj.isrealname"}},[i("Radio",{attrs:{label:0}},[t._v("匿名")]),t._v(" "),i("Radio",{attrs:{label:1}},[t._v("实名")])],1)],1),t._v(" "),i("FormItem",{attrs:{label:"选择时间："}},[i("div",[t._v("开始日期："),i("DatePicker",{staticStyle:{width:"140px"},attrs:{type:"date",value:t.begintime,placeholder:"开始日期"},on:{"on-change":t.selectDatesBegin}})],1),t._v(" "),i("div",[t._v("结束日期："),i("DatePicker",{staticStyle:{width:"140px"},attrs:{type:"date",value:t.endtime,placeholder:"结束日期"},on:{"on-change":t.selectDatesEnd}})],1)])],1),t._v(" "),i("div",{staticClass:"zmiti-add-form-item zmiti-add-btns"},[i("Button",{attrs:{size:"large",type:"primary"},on:{click:t.adminAction}},[t._v(t._s(t.formObj.voteid?"保存":"确定"))])],1)],1)])],1)])],1)};b._withStripped=!0;var u=i(3),v=!1;var f=function(t){v||i(680)},h=Object(u.a)(g,b,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("span",[this._v("投票管理")])])}],!1,f,"data-v-2cbac992",null);h.options.__file="components\\votemanager\\index\\index.vue";e.default=h.exports}}]);